(function(){
    'use strict';

    angular.module('vatbook.services')
    .factory('ClientApi', ['$resource', function($resource){
        var Endpoint = $resource('/vatbook/admin/client/:id', {id: '@_id'},{
            update:{
                method: 'PUT'
            }
        }),
        repository = {};

        repository.list = function(){
            return Endpoint.query().$promise;
        };

        repository.save = function(client){
            var client = new Endpoint(client);
            return client.$save();
        };

        repository.update = function(data){
            var item = Endpoint.get({id:data.id});
            item.identifier = data.identifier;
            item.full_name = data.full_name;
            // TODO: add jquery extends instead of manual
            return item.$update({id:data.id});
        };

        repository.get = function(id){
            return Endpoint.get({id:id}).$promise;
        };

        repository.remove = function(id){
            return Endpoint.delete({id:id}).$promise;
        };

        return repository;
    }]);
}());
