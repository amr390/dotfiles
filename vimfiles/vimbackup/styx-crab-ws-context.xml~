<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jaxws="http://cxf.apache.org/jaxws"
	xmlns:osgix="http://www.springframework.org/schema/osgi-compendium"
	xmlns:ctx="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/osgi-compendium http://www.springframework.org/schema/osgi-compendium/spring-osgi-compendium.xsd
                        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
                        http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">

	<osgix:cm-properties id="crabProperties" persistent-id="crab" />
	<ctx:property-placeholder properties-ref="crabProperties" system-properties-mode="NEVER" />

	<bean id="crabWSFeed" class="be.cipal.styx.crab.ws.impl.CrabWebserviceProviderImpl">
        <property name="cityParser" ref="crabToStyxCityParser" />
        <property name="streetParser" ref="crabToStyxStreetParser" />
        <property name="houseNumberParser" ref="crabToStyxHouseNumberParser" />
        <property name="postalCodeParser" ref="crabToStyxPostalCodeParser" />
        <property name="positionParser" ref="crabToStyxPositionParser" />
		<property name="crabService" ref="crabWebservice" />
	</bean>

	<bean id="crabDBFeed" class="be.cipal.styx.crab.ws.impl.CrabDatabaseProviderImpl">
		<property name="cityParser" ref="crabToStyxCityParser" />
		<property name="streetParser" ref="crabToStyxStreetParser" />
		<property name="houseNumberParser" ref="crabToStyxHouseNumberParser" />
		<property name="postalCodeParser" ref="crabToStyxPostalCodeParser" />
		<property name="positionParser" ref="crabToStyxPositionParser" />
		<property name="crabService" ref="crabDBService" />
	</bean>

	<bean id="crabDBService" class="be.cipal.styx.crab.ws.service.CrabDatabaseService">
		<property name="crabWebservice" ref="iwsCrab" />
		<property name="comboPooledDataSource" ref="comboPooledDatasource" />
	</bean>

	<bean id="crabWebservice" class="be.cipal.styx.crab.ws.service.CrabWebservice">
		<property name="crabWebservice" ref="iwsCrab" />
	</bean>

	<bean id="crabToStyxCityParser" class="be.cipal.styx.crab.ws.impl.parser.CrabToStyxCityParser">
		<constructor-arg ref="cityFacade" />
		<constructor-arg ref="parserHelper" />
	</bean>

	<bean id="crabToStyxStreetParser" class="be.cipal.styx.crab.ws.impl.parser.CrabToStyxStreetParser">
		<constructor-arg ref="streetFacade" />
		<constructor-arg ref="parserHelper" />
	</bean>

	<bean id="crabToStyxHouseNumberParser" class="be.cipal.styx.crab.ws.impl.parser.CrabToStyxHouseNumberParser">
		<constructor-arg ref="houseNumberFacade" />
		<constructor-arg ref="parserHelper" />
	</bean>

	<bean id="crabToStyxPostalCodeParser"
		class="be.cipal.styx.crab.ws.impl.parser.CrabToStyxPostalCodeParser">
		<property name="postalCodeFacade" ref="postalCodeFacade" />
		<property name="parserHelper" ref="parserHelper" />
	</bean>

	<bean id="crabToStyxPositionParser"
		class="be.cipal.styx.crab.ws.impl.parser.CrabToStyxPositionParser">
		<property name="houseNumberFacade" ref="houseNumberFacade" />
	</bean>

	<!-- Whatever the facade that implements AreraFacade and extends AReaFacadeImpl could be
		 a valid property for this helper. -->
	<bean id="parserHelper" class="be.cipal.styx.crab.ws.impl.parser.CrabParserHelper" >
		<property name="areaFacade" ref="cityFacade" />
	</bean>

	<bean name="comboPooledDatasource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
		<property name="driverClass" value="oracle.jdbc.OracleDriver"/>
        <property name="jdbcUrl" value="${db.url2}"/>
        <property name="user" value="${db.username2}"/>
        <property name="password" value="${db.password2}"/>
	</bean>

	<jaxws:client id="iwsCrab" serviceClass="be.agiv.ws.crabws.IWsCrab" address="${crab.url}"> </jaxws:client>

<!--
	<jaxws:client id="crabService" serviceClass="be.agiv.ws.crabws.IWsCrab"
		address="http://crab.agiv.be/wscrab/WsCrab.svc">
	</jaxws:client>
-->
</beans>
