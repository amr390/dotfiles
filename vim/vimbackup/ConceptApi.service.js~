(function(){
    'use strict';

    angular.module('vatbook.services')
    .factory('ConceptApi', ['$resource', function($resource){
        var Endpoint = $resource('/vatbook/admin/concept/:id', {id: '@_id'},{
            update:{
                method: 'PUT'
            }
        }),
        repository = {};

        repository.list = function(){
            return Endpoint.query().$promise;
        };

        repository.save = function(concept){
            var concept = new Endpoint(concept);
            return concept.$save();
        };

        repository.update = function(data){
            var item = Endpoint.get({id:data.id});
            item.name = data.name;
            item.description = data.description;
            item.vat_type = data.vat_type;
            item.vat_cost = data.vat_cost;
            // TODO: add jquery extends instead of manual
            return item.$update({id:data.id});
        };

        repository.get = function(id){
            return Endpoint.get({id:id}).$promise;
        };

        repository.remove = function(id){
            return Endpoint.delete({id:id}).$promise;
        };

        return repository;
    }]);
}());
